<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anchor Core</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="noise-overlay"></div>
    <div id="connect-screen" class="connect-screen">
        <div class="connect-card">
            <div class="brand-header">
                <img src="logo.svg" alt="Anchor Logo" class="brand-logo-large">
                <h1>Anchor Core‚Ñ¢</h1>
            </div>
            <p class="connect-intro">Connect this device to the local Anchor network.</p>
            <div class="input-group">
                <input type="text" id="device-type" placeholder="Device Type (e.g. Laptop)" class="connect-input">
                <input type="text" id="user-name" placeholder="User Name (e.g. jaDev)" class="connect-input">
            </div>
            <button onclick="connect()" class="connect-btn">Connect Device</button>
        </div>
    </div>

    <div id="dashboard-screen" class="hidden">
        <h1><img src="logo.svg" alt="Anchor Logo" class="brand-logo"> Anchor Core‚Ñ¢ <span id="badge"
                class="badge">INITIALIZING</span></h1>

        <!-- Summary Stats -->
        <div class="summary-row">
            <div class="metric">Devices: <span id="count-total" class="metric-value">-</span></div>
            <div class="metric">Online: <span id="count-online" class="metric-value">-</span></div>
            <div class="metric">Offline: <span id="count-offline" class="metric-value">-</span></div>
            <div class="metric">Security: <span id="count-security" class="metric-value"
                    style="color: var(--accent-green)">Secure</span></div>
        </div>

        <!-- Security Alert Banner -->
        <div id="security-alert-bar" class="security-banner hidden">
            <span class="icon">üö®</span>
            <span id="security-msg">Security Threat Detected</span>
        </div>

        <div id="loading" class="empty-state" style="border: none;">Scanning for devices...</div>
        <div class="device-list" id="list"></div>
    </div>

    <!-- Device Details Modal -->
    <div id="device-modal-overlay" class="modal-overlay hidden" onclick="if(event.target === this) closePanel()">
        <div id="device-details-panel" class="device-modal">
            <div class="panel-header">
                <div class="header-main">
                    <h2 id="panel-device-name">Device Name</h2>
                    <span id="meta-status-badge" class="status-badge">Online</span>
                </div>
                <button onclick="closePanel()" class="close-modal-btn">√ó</button>
            </div>

            <div class="panel-grid">
                <!-- Left: Visuals & Performance -->
                <div class="panel-left">
                    <div class="panel-section">
                        <h3>Screen Preview <span id="live-indicator" class="live-pulse hidden">LIVE</span></h3>
                        <div class="preview-container">
                            <div id="preview-placeholder" class="preview-load">
                                <span>Establishing Live Stream...</span>
                            </div>
                            <video id="preview-video" class="hidden" autoplay muted playsinline></video>
                            <img id="preview-img" class="hidden" alt="Device Snapshot Fallback">
                        </div>
                    </div>

                    <div class="panel-section">
                        <h3>Reliability & Uptime</h3>
                        <div class="uptime-container">
                            <div class="uptime-bar" id="uptime-bar">
                                <!-- Bars generated via JS -->
                            </div>
                            <div class="uptime-stats">
                                <span>Uptime: <span id="uptime-pct">100</span>%</span>
                                <span id="uptime-trend">Stable</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Metadata & Actions -->
                <div class="panel-right">
                    <div class="panel-section">
                        <h3>Metadata</h3>
                        <div class="meta-grid">
                            <div class="meta-item"><span>Type</span> <span id="meta-type">-</span></div>
                            <div class="meta-item"><span>User</span> <span id="meta-user">-</span></div>
                            <div class="meta-item"><span>IP Address</span> <span id="meta-ip">-</span></div>
                            <div class="meta-item"><span>Last Seen</span> <span id="meta-seen">-</span></div>
                            <div class="meta-item full"><span>Activity</span> <span id="meta-activity">Idle</span></div>
                            <div class="meta-item full"><span>Browser</span> <span id="meta-browser"
                                    class="truncate">-</span></div>
                            <div class="meta-item full"><span>Device ID</span> <span id="meta-id"
                                    class="truncate">-</span></div>
                        </div>
                    </div>

                    <div class="panel-section">
                        <h3>Actions</h3>
                        <div class="action-flex">
                            <button onclick="pingDevice()" class="action-btn">
                                <span class="icon">üîî</span> Ping
                            </button>
                            <button onclick="testLatency()" class="action-btn">
                                <span class="icon">üì∂</span> Latency
                            </button>
                            <button onclick="triggerFilePush()" class="action-btn">
                                <span class="icon">üìÇ</span> Push File
                            </button>
                            <button onclick="requestGPS()" class="action-btn">
                                <span class="icon">üåç</span> GPS
                            </button>
                            <button onclick="identifyDevice()" class="action-btn">
                                <span class="icon">üî¶</span> Identify
                            </button>
                            <button onclick="remoteLaunch()" class="action-btn">
                                <span class="icon">üöÄ</span> Launch
                            </button>
                            <button onclick="sendRemoteAlert()" class="action-btn">
                                <span class="icon">üí¨</span> Alert
                            </button>
                        </div>
                        <input type="file" id="file-push-input" class="hidden" onchange="handleFileSelected(this)">
                        <div id="latency-result" class="latency-display hidden">
                            Round-trip Time: <span id="latency-value">-</span>ms
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- html2canvas for screen capture -->
    <div id="identify-overlay" class="identify-overlay hidden"></div>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <div id="toast-container" class="toast-container"></div>
    <script src="app.js"></script>
    <footer class="animated-footer">
        Developed by <a href="https://github.com/jABurat23" target="_blank" rel="noopener noreferrer">jABurat23</a> ‚Ä¢
        <span style="opacity: 0.6">v1.0.0</span>
    </footer>
</body>

</html>